#!/usr/bin/env bash
set -euo pipefail
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
NPROCS="${NPROCS:-}"
while getopts ":j:" opt; do
  case $opt in
    j) NPROCS="$OPTARG" ;;
  esac
done
if [[ -z "${NPROCS}" ]]; then
  if command -v nproc >/dev/null 2>&1; then NPROCS="$(nproc)"; else NPROCS=4; fi
fi
( cd "$SCRIPT_DIR/rhoHyperFoam" && ./Allwmake -j "${NPROCS}" )
